<!DOCTYPE html>
<html lang="en"><head>
<script src="tidying-wrangling-data_files/libs/clipboard/clipboard.min.js"></script>
<script src="tidying-wrangling-data_files/libs/quarto-html/tabby.min.js"></script>
<script src="tidying-wrangling-data_files/libs/quarto-html/popper.min.js"></script>
<script src="tidying-wrangling-data_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="tidying-wrangling-data_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="tidying-wrangling-data_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="tidying-wrangling-data_files/libs/quarto-html/quarto-syntax-highlighting-de84f8d6bb715db06a919283c2d1e787.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.42">

  <meta name="dcterms.date" content="2025-01-31">
  <title>TIDYING &amp; WRANGLING DATA</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="tidying-wrangling-data_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="tidying-wrangling-data_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #d73a49; } /* Attribute */
    code span.bn { color: #005cc5; } /* BaseN */
    code span.bu { color: #d73a49; } /* BuiltIn */
    code span.cf { color: #d73a49; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #005cc5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #d73a49; } /* DataType */
    code span.dv { color: #005cc5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #d73a49; font-weight: bold; } /* Extension */
    code span.fl { color: #005cc5; } /* Float */
    code span.fu { color: #6f42c1; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #d73a49; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #6f42c1; } /* Other */
    code span.pp { color: #d73a49; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #005cc5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #032f62; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
  </style>
  <link rel="stylesheet" href="tidying-wrangling-data_files/libs/revealjs/dist/theme/quarto-6fe1483203e922e2d16de12554bd5e7b.css">
  <link href="tidying-wrangling-data_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="tidying-wrangling-data_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="tidying-wrangling-data_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="tidying-wrangling-data_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="tidying-wrangling-data_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="tidying-wrangling-data_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">TIDYING &amp; WRANGLING DATA</h1>
  <p class="subtitle">tidyr, purrr, stringr, forcats</p>

<div class="quarto-title-authors">
</div>

  <p class="date">2025-01-31</p>
</section>
<section id="housekeeping-reminders" class="slide level2 smaller">
<h2>HOUSEKEEPING &amp; REMINDERS</h2>
<div>
<ul>
<li class="fragment"><p><strong>FOLLOW ALONG</strong> with today’s lecture in the <code>in-class-materials/demo-snippets.R</code> file in the assessment repo (ie pull it now!)</p></li>
<li class="fragment"><p><strong>git stuff</strong> - I’m going to put together a walkthrough for extra help managing your fork</p></li>
<li class="fragment"><p>In the meantime, following the <strong>cardinal rules of git</strong> will solve 99% of issues and avert merge conflicts:</p>
<ul>
<li class="fragment"><strong>PULL</strong> from upstream at the start of any session</li>
<li class="fragment"><strong>COMMIT</strong> frequently, but most critically at the end of every session<br>
</li>
<li class="fragment"><strong>PUSH</strong> commits at the end of every session</li>
</ul></li>
<li class="fragment"><p><strong>assessment repo mistake</strong> - the cleaning-level-1 project folder included an old assessment file that should not have been there</p>
<ul>
<li class="fragment">I renamed the file <code>assessment_old.md</code> rather than delete it</li>
<li class="fragment">If you have not already submitted this project, <strong>DO NOT USE THAT ASSESSMENT FILE!</strong> Use the current one from the root directory</li>
</ul></li>
</ul>
</div>
</section>
<section>
<section id="core-packages-for-tidy-data-prep-manipulation" class="title-slide slide level1 center">
<h1>CORE PACKAGES FOR TIDY DATA PREP &amp; MANIPULATION</h1>

</section>
<section id="core-tidyverse-packages-today" class="slide level2">
<h2>Core Tidyverse Packages: Today</h2>
<div class="columns">
<div class="column" style="width:20%;">
<p><strong>tibble</strong><br>
reimagine the dataframe!</p>
</div><div class="column" style="width:20%;">
<p><strong>readr</strong><br>
easily import and export tabular data</p>
</div><div class="column" style="width:20%;">
<p><strong>dplyr</strong><br>
a grammar of data manipulation</p>
</div><div class="column" style="width:20%;">
<p><strong>tidyr</strong><br>
tidy your messy data</p>
</div><div class="column" style="width:20%;">
<p><strong>ggplot2</strong><br>
a grammar of graphics</p>
</div></div>
<div class="columns fragment">
<div class="column" style="width:25%;">
<p><strong>purrr</strong><br>
enhancements for R’s functional programming</p>
</div><div class="column" style="width:25%;">
<p><strong>stringr</strong><br>
simplify working with strings</p>
</div><div class="column" style="width:25%;">
<p><strong>forcats</strong><br>
simplify working with factors</p>
</div><div class="column" style="width:25%;">

</div></div>
</section></section>
<section>
<section id="combining-datasets" class="title-slide slide level1 center">
<h1>COMBINING DATA(SETS)</h1>
<p><em>actually part of dplyr, not tidyr – but conceptually related</em></p>
</section>
<section id="bind-rows" class="slide level2 smaller scrollable">
<h2>BIND ROWS</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="append-rows-of-one-dataframe-after-the-last-row-of-another">Append rows of one dataframe after the last row of another</h3>
<p><strong>base::rbind()</strong> - dataframes must have exactly the same columns in the same order</p>
<p><strong>dplyr::bind_rows()</strong> - dataframes can have different column structures - missing values will be treated as NA</p>
</div><div class="column" style="width:50%;">
<h3 id="whats-with-the-base-and-dplyr-bits">What’s with the base:: and dplyr:: bits?</h3>
<p>It’s a shortcut to specify what package the function comes from. Usually not necessary in your actual code, but it can come in handy when:</p>
<ol type="1">
<li>you don’t have that package loaded and you just need that single specific function</li>
<li>you have multiple packages loaded that define that function and you want to specify which of them to use</li>
</ol>
</div></div>
</section>
<section id="bind-columns" class="slide level2 smaller">
<h2>BIND COLUMNS</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="append-columns-of-one-dataframe-after-the-last-column-of-another">Append columns of one dataframe after the last column of another</h3>
<p><strong>base::cbind()</strong> - dataframes must have the same number of rows</p>
<p><strong>dplyr::bind_cols()</strong> - dataframes must have the same number of rows</p>
</div><div class="column" style="width:50%;">
<h3 id="if-they-work-the-same-way-which-should-i-use">If they work the same way, which should I use?</h3>
<p><strong>Neither! Use joins instead.</strong></p>
</div></div>
</section>
<section id="merge-data-with-_join-functions" class="slide level2">
<h2>MERGE DATA WITH *_join() FUNCTIONS</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="sc">*</span><span class="fu">_join</span>(left.tbl, right.tbl, <span class="at">by =</span> ...)</span>
<span id="cb1-2"><a href=""></a><span class="co"># replace * with left, right, inner, or full</span></span>
<span id="cb1-3"><a href=""></a><span class="co"># the first dataframe is "left" and second is "right", </span></span>
<span id="cb1-4"><a href=""></a><span class="co"># whether you name both in the function or name one then pipe </span></span>
<span id="cb1-5"><a href=""></a><span class="co"># it into the function</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>left_join()</strong> - includes all the rows of x and only the rows of y that have matches in x</p>
<p><strong>right_join()</strong> - includes all the rows of y and only the rows of x that have matches in y</p>
</div><div class="column" style="width:50%;">
<p><strong>inner_join()</strong> - includes only rows present in both x and y</p>
<p><strong>full_join()</strong> - includes all rows present in either x or y, matched where possible</p>
</div></div>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>See r4ds Chapter 19: Joins for more explanation</p>
</div>
</div>
</div>
</section>
<section id="join-merge-2-tibbles-into-1" class="slide level2">
<h2><span class="smaller">*_join(): Merge 2 Tibbles into 1</span></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" data-code-line-numbers="|1-3|5-7|9-11|13-16|18-19|21-22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a><span class="co"># these are all identical</span></span>
<span id="cb2-2"><a href=""></a><span class="fu">left_join</span>(band_members, band_instruments)</span>
<span id="cb2-3"><a href=""></a><span class="fu">left_join</span>(band_members, band_instruments, <span class="at">by =</span> <span class="fu">join_by</span>(name)) </span>
<span id="cb2-4"><a href=""></a><span class="fu">left_join</span>(band_members, band_instruments, <span class="at">by =</span> <span class="st">"name"</span>)</span>
<span id="cb2-5"><a href=""></a></span>
<span id="cb2-6"><a href=""></a><span class="fu">right_join</span>(band_instruments, band_members)</span>
<span id="cb2-7"><a href=""></a>band_instruments <span class="sc">%&gt;%</span> </span>
<span id="cb2-8"><a href=""></a>  <span class="fu">right_join</span>(band_members, <span class="at">by =</span> <span class="st">"name"</span>)</span>
<span id="cb2-9"><a href=""></a></span>
<span id="cb2-10"><a href=""></a><span class="co"># specify to match columns with different names:</span></span>
<span id="cb2-11"><a href=""></a><span class="co"># by = join_by(name == artist)</span></span>
<span id="cb2-12"><a href=""></a></span>
<span id="cb2-13"><a href=""></a><span class="co"># specify multiple columns to match: </span></span>
<span id="cb2-14"><a href=""></a><span class="co"># join_by(a, c == d)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<ul>
<li>use <code>by = join_by(colname)</code> or <code>by = "colname"</code> to specify which columns should match</li>
<li>if by is not specified, it assumes all identically named columns should match</li>
</ul>
</div>
</div>
</div>
</section></section>
<section>
<section id="tidyr" class="title-slide slide level1 center">
<h1>tidyr</h1>
<p><em>with a quick review of “tidy” data</em></p>
</section>
<section id="tibbles-tidy-data" class="slide level2 smaller scrollable">
<h2>TIBBLES, TIDY DATA</h2>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li><strong>Tibbles</strong> are a kind of data.frame designed to simplify working with tabular data</li>
<li>Tibbles work best with <strong>tidy data</strong></li>
<li>In fact, the whole tidyverse revolves around tidy data</li>
</ul>
<h3 id="tidy-data-rules">Tidy Data Rules:</h3>
<ol type="1">
<li>Each variable forms a column</li>
<li>Each observation forms a row<br>
</li>
<li>Each cell is a single measurement</li>
</ol>
</div><div class="column" style="width:40%;">
<h3 id="tidyr-tidy-data-wrangling">tidyr: TIDY DATA WRANGLING</h3>
<ul>
<li>Create tidy data from any data to use within the tidyverse</li>
<li><a href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf">Cheatsheet</a></li>
</ul>
<p><strong>pivot</strong> - reshape data<br>
<strong>split &amp; combine</strong> - separate &amp; merge column values<br>
<strong>missing values</strong> - make missing data implicit or explicit<br>
<strong>nest</strong> - restructure embedded data<br>
<strong>rectangle</strong> - turn deeply nested data into tibbles</p>
</div></div>
</section>
<section id="pivoting-long-wide-data" class="slide level2 smaller">
<h2>PIVOTING: LONG &amp; WIDE DATA</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="wide-data">WIDE DATA</h3>
<ul>
<li>What you’re used to; “the Excel way”</li>
<li>First column contains unique values</li>
<li>Compact and human-friendly</li>
<li>Lacks precision, hard to manipulate structurally</li>
<li>create with <code>pivot_wider()</code></li>
<li><em>formerly/alternatively: spread, cast, pivot, unfold</em></li>
</ul>
</div><div class="column" style="width:50%;">
<h3 id="long-data">LONG DATA</h3>
<ul>
<li>What the tidyverse wants</li>
<li>First column repeats values</li>
<li>Difficulty to spot patterns or comparisons</li>
<li>Easily manipulable, precise, standardized<br>
</li>
<li>create with <code>pivot_longer()</code></li>
<li><em>formerly/alternatively: gather, melt, unpivot, fold</em></li>
</ul>
</div></div>
</section>
<section id="pivot_longer-reshape-wide-to-long" class="slide level2 smaller">
<h2>pivot_longer(): RESHAPE WIDE TO LONG</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" data-code-line-numbers="|1|3-8|9|10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a><span class="fu">pivot_longer</span>(tbl, cols, ..., names_to, values_to...)</span>
<span id="cb3-2"><a href=""></a></span>
<span id="cb3-3"><a href=""></a><span class="co"># Convert wide mmdata to long</span></span>
<span id="cb3-4"><a href=""></a><span class="co"># Where is the count of m&amp;ms of each color in each bag stored?</span></span>
<span id="cb3-5"><a href=""></a><span class="co"># mmdata: colors are columns; count values in grid</span></span>
<span id="cb3-6"><a href=""></a><span class="co"># mmdata.long: colors are values; all counts listed in single "Number" column</span></span>
<span id="cb3-7"><a href=""></a>mmdata.long <span class="ot">&lt;-</span> mmdata <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href=""></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"Red"</span>, <span class="st">"Green"</span>, <span class="st">"Blue"</span>, <span class="st">"Orange"</span>, <span class="st">"Yellow"</span>, <span class="st">"Brown"</span>),</span>
<span id="cb3-9"><a href=""></a>               <span class="at">names_to =</span> <span class="st">"Color"</span>,</span>
<span id="cb3-10"><a href=""></a>               <span class="at">values_to =</span> <span class="st">"Number"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p><strong>names_to:</strong> “Turn the pivoted column NAMES_TO values in a new column with this name.”<br>
<strong>values_to:</strong> “Within the pivoted columns, move the VALUES_TO a new column with this name.”</p>
</div>
</div>
</div>
</section>
<section id="pivot_wider-reshape-long-to-wide" class="slide level2 smaller">
<h2>pivot_wider(): RESHAPE LONG TO WIDE</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" data-code-line-numbers="|1|3-8|9-12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a><span class="fu">pivot_wider</span>(tbl, cols, ..., names_from, values_from...)</span>
<span id="cb4-2"><a href=""></a></span>
<span id="cb4-3"><a href=""></a><span class="co"># Convert mmdata.long to wide</span></span>
<span id="cb4-4"><a href=""></a><span class="co"># Where is the count of m&amp;ms of each color in each bag stored?</span></span>
<span id="cb4-5"><a href=""></a><span class="co"># mmdata.long: colors are values; all counts listed in single "Number" column</span></span>
<span id="cb4-6"><a href=""></a><span class="co"># mmdata.wide: colors are columns; count values in grid – identical to mmdata</span></span>
<span id="cb4-7"><a href=""></a>mmdata.wide <span class="ot">&lt;-</span> mmdata.long <span class="sc">%&gt;%</span></span>
<span id="cb4-8"><a href=""></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"Color"</span>,</span>
<span id="cb4-9"><a href=""></a>              <span class="at">values_from =</span> <span class="st">"Number"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-10"><a href=""></a>  <span class="fu">relocate</span>(Weight, <span class="at">.after =</span> <span class="fu">last_col</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p><strong>names_from:</strong> “Create new column NAMES_FROM the values in the column with this name.”<br>
<strong>values_from:</strong> “Fill in the new columns with VALUES_FROM the column with this name.”</p>
</div>
</div>
</div>
</section>
<section id="separate-break-apart-values" class="slide level2 smaller">
<h2>separate(): BREAK APART VALUES</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" data-code-line-numbers="|1|3-6|8-12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a><span class="fu">separate</span>(tbl, col, newcols, sep)</span>
<span id="cb5-2"><a href=""></a></span>
<span id="cb5-3"><a href=""></a><span class="co"># Separate "notes" column into two columns by recognizing "_" separator</span></span>
<span id="cb5-4"><a href=""></a>glasses.sep <span class="ot">&lt;-</span> glasses <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href=""></a>  <span class="fu">separate</span>(notes, <span class="fu">c</span>(<span class="st">"vision_correction"</span>, <span class="st">"other_notes"</span>),</span>
<span id="cb5-6"><a href=""></a>           <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb5-7"><a href=""></a></span>
<span id="cb5-8"><a href=""></a><span class="co"># separate() has been superseded:</span></span>
<span id="cb5-9"><a href=""></a><span class="co"># separate_wider_delim() will split based on a given separator, like separate()</span></span>
<span id="cb5-10"><a href=""></a><span class="co"># but has slightly different syntax:</span></span>
<span id="cb5-11"><a href=""></a><span class="co"># separate_wider_delim(tbl, col, delim, newcols)</span></span>
<span id="cb5-12"><a href=""></a>glasses.sep.delim <span class="ot">&lt;-</span> glasses <span class="sc">%&gt;%</span></span>
<span id="cb5-13"><a href=""></a>  <span class="fu">separate_wider_delim</span>(notes, <span class="at">delim =</span> <span class="st">"_"</span>, </span>
<span id="cb5-14"><a href=""></a>                       <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"vision_correction"</span>, <span class="st">"other_notes"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="unite-collapse-values-to-a-single-column" class="slide level2 smaller">
<h2>unite(): COLLAPSE VALUES TO A SINGLE COLUMN</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" data-code-line-numbers="|1|3-6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a><span class="fu">unite</span>(tbl, newcol, cols, sep)</span>
<span id="cb6-2"><a href=""></a></span>
<span id="cb6-3"><a href=""></a><span class="co"># Unite the 2 columns back to 1 with a new separator (use ; not _)</span></span>
<span id="cb6-4"><a href=""></a>glasses.unite <span class="ot">&lt;-</span> glasses.sep <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href=""></a>  <span class="fu">unite</span>(<span class="st">"semicolon_notes"</span>,</span>
<span id="cb6-6"><a href=""></a>        <span class="st">"vision_correction"</span><span class="sc">:</span><span class="st">"other_notes"</span>, </span>
<span id="cb6-7"><a href=""></a>        <span class="at">sep =</span> <span class="st">";"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="handling-missing-values" class="slide level2 smaller">
<h2>HANDLING MISSING VALUES</h2>
<p>Create new combinations of variables or identify missing values that should be present in the data.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>expand()</strong> - create a new tibble with all possible combinations of the passed columns; drop other columns</p>
<p><strong>complete()</strong> - add missing possible combinations of passed columns; fill in missing data in other columns with NA</p>
<p><strong>drop_na()</strong> - drop all rows containing NAs in the passed columns</p>
</div><div class="column" style="width:50%;">
<p><strong>fill()</strong> - replace NAs with the next or previous non-empty value</p>
<p><strong>replace_na()</strong> - replace NAs with some value</p>
</div></div>
</section>
<section id="nesting" class="slide level2 smaller">
<h2>NESTING</h2>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p>Beyond the scope of this class, but good to know how powerful tidyr is!</p>
</div>
</div>
</div>
<ul>
<li><strong>nested df</strong> is one where 1+ columns is a list of data frames</li>
<li>conceptually related to grouping with <code>group_by()</code>: each row in the input corresponds to one group in the output</li>
<li>imagine a data frame with columns x, y, and z
<ul>
<li><code>df %&gt;% group_by(x) %&gt;% summarize(mean = mean(y), sum = sum(z))</code></li>
<li>each row in the summarized output processes data about multiple rows in the input</li>
</ul></li>
<li><code>df2 %&gt;% nest(my_nested_var = c(y, z))</code>
<ul>
<li>each row in the nested output contains the data itself as defined by unique values of everything that isn’t nested</li>
<li>since the data is unchanged, the data in the new variable is itself a table (or tibble)</li>
</ul></li>
</ul>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>See <a href="https://tidyr.tidyverse.org/articles/nest.html">tidyverse article on nesting</a> for more info</p>
</div>
</div>
</div>
</section>
<section id="rectangling" class="slide level2 smaller">
<h2>RECTANGLING</h2>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p>Also beyond the scope of this class! But if you’re using JSON data you need to understand this.</p>
</div>
</div>
</div>
<ul>
<li>Turns nested lists into tidy tibbles</li>
<li>Useful for deeply nested formats like JSON, but not typically necessary for working with data already in a tabular format</li>
</ul>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>For more info see <a href="https://tidyr.tidyverse.org/articles/rectangle.html">tidyverse article on rectangling</a> with <code>unnest_longer()</code>, <code>unnest_wider()</code>, &amp; <code>hoist()</code></p>
</div>
</div>
</div>
</section></section>
<section>
<section id="purrr" class="title-slide slide level1 center">
<h1>purrr</h1>

</section>
<section id="purrr-1" class="slide level2 smaller">
<h2>PURRR</h2>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p>Yet again, beyond the scope of this class.</p>
</div>
</div>
</div>
<p>But it’s a core tidyverse package so it’s worth saying:</p>
<ul>
<li>it’s a way to apply functions across all items in one or more lists, including functions using relationships across lists</li>
<li>centers on the <code>map()</code> family of functions are an alternative to base <code>apply()</code> family</li>
<li>Also allows for “purrr-style lambda syntax” for using “anonymous functions”
<ul>
<li>Looks like this: <code>map(xs, ~ mean((.x + 5)^2))</code></li>
<li>But is being phased out in favor of base R lambda syntax: <code>map(xs, \(x) mean((x + 5)^2))</code></li>
</ul></li>
<li>You’ll see this in a lot of tidyverse documentation (both the old and new syntax)</li>
</ul>
</section></section>
<section>
<section id="stringr" class="title-slide slide level1 center">
<h1>stringr</h1>

</section>
<section id="strings" class="slide level2 smaller">
<h2>STRINGS</h2>
<p><strong>Strings</strong> are ordered sequences of any characters</p>
<ul>
<li>aka “character vectors”, an ordered list of individual characters</li>
<li>Surrounded with ‘single’ or “double quotes”
<ul>
<li>The other one can then be used within the string</li>
</ul></li>
<li>Special characters are “escaped” with a backslash:
<ul>
<li><code>\@</code>, <code>\#</code>, <code>\"</code></li>
<li>escape the escape signifier: <code>\\</code></li>
</ul></li>
</ul>
</section>
<section id="useful-base-r-string-functions" class="slide level2 smaller">
<h2>USEFUL BASE R STRING FUNCTIONS</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>merge multiple strings into a single string:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a><span class="fu">paste</span>(<span class="st">"x"</span>, <span class="st">"y"</span>) <span class="co"># [1] "x y"</span></span>
<span id="cb7-2"><a href=""></a><span class="fu">paste0</span>(<span class="st">"x"</span>, <span class="st">"y"</span>) <span class="co"># [1] "xy"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>concatenate multiple strings into a list:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href=""></a><span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>) <span class="co"># [1] "x" "y"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>change case:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a><span class="fu">toupper</span>(<span class="st">"xyz"</span>) <span class="co"># [1] "XYZ"</span></span>
<span id="cb9-2"><a href=""></a><span class="fu">tolower</span>(<span class="st">"XYZ"</span>) <span class="co"># [1] "xyz"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>is this a string?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href=""></a><span class="fu">is.character</span>(<span class="dv">123</span>) <span class="co"># [1] FALSE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>turn this into a string:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href=""></a><span class="fu">toString</span>(<span class="dv">123</span>) <span class="co"># [1] "123"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div></div>
</section>
<section id="regular-expressions" class="slide level2 smaller">
<h2>REGULAR EXPRESSIONS</h2>
<div class="columns">
<div class="column" style="width:70%;">
<ul>
<li>A <strong>standardized form of pattern matching</strong> in strings</li>
<li>Use “grep” functions – global regular expression (search and) print</li>
<li>base R has grep functions:
<ul>
<li><code>grep()</code>, <code>grepl()</code>, <code>gsub()</code>, and more…</li>
</ul></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="https://imgs.xkcd.com/comics/regular_expressions.png" class="quarto-figure quarto-figure-center" width="400"></p>
</figure>
</div>
</div><div class="column" style="width:30%;">
<h3 id="stringr-detect-matches">stringr: DETECT MATCHES</h3>
<p><strong>stringr functions are grep functions</strong> designed to be more: - convenient - intuitive<br>
- compatible with tidyverse (and pipes) - use regex or simplified stringr specific string matching - <strong>stringr functions begin with prefix <code>str_</code></strong></p>
</div></div>
</section>
<section id="stringr-detect-matches-1" class="slide level2 smaller">
<h2>stringr: DETECT MATCHES</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>str_detect(), str_starts(), str_ends()</strong><br>
return whether a string contains/starts with/ends with a pattern match</p>
<p><strong>str_count()</strong><br>
count the number of times a pattern occurs in a string</p>
</div><div class="column" style="width:50%;">
<p><strong>str_subset()</strong><br>
return strings that match a pattern</p>
<p><strong>str_length()</strong><br>
return length (# characters) in a string</p>
<p><strong>str_pad(), str_trunc()</strong><br>
make strings a constant length by adding or removing characters</p>
<p><strong>str_trim()</strong><br>
remove whitespace</p>
</div></div>
</section>
<section id="stringr-mutate-join-and-split" class="slide level2 smaller">
<h2>stringr: MUTATE, JOIN, AND SPLIT</h2>
<p><strong>str_sub()</strong> - (extract or) replace substrings</p>
<p><strong>str_replace<a href="">_all</a></strong> - replace first substring [all substrings] matching a pattern</p>
<p><strong>str_remove<a href="">_all</a></strong> - remove first substring [all substrings] matching a pattern</p>
<p><strong>str_to_<a href="">lower/upper/title</a></strong> - convert characters in string to lower, upper, or title case (comparable to base <code>tolower()</code> and <code>toupper()</code>)</p>
<p><strong>str_c() &amp; str_glue()</strong> - join multiple strings into one string - comparable to <code>paste0()</code>; <code>str_glue</code> allows for inclusion of expressions</p>
<p><strong>str_flatten()</strong> - create one string from a list of strings</p>
</section></section>
<section>
<section id="forcats" class="title-slide slide level1 center">
<h1>forcats</h1>

</section>
<section id="factor-variables" class="slide level2 smaller">
<h2>FACTOR VARIABLES</h2>
<p><strong>Factors are what R calls categorical variables</strong></p>
<ul>
<li>usually look like strings</li>
<li>may look like numeric or logical variables</li>
<li>can be <strong>ordered</strong> (e.g., “high school”, “some college”, “college degree”)</li>
<li>or <strong>unordered</strong> (e.g., “education”, “finance”, “hospitality”)</li>
</ul>
<p><strong>Factors have levels</strong></p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>What about labels?</strong></p>
</div>
<div class="callout-content">
<p>Factor “levels” and “labels” in R are not equivalent to how they are used in some other languages (e.g., Stata, SPSS). Labels are used as one option for recoding levels. Effectively, a level’s label is the level itself. If you don’t like this, there are packages that change this behavior (e.g., labelled).</p>
</div>
</div>
</div>
</section>
<section id="key-factor-functions" class="slide level2 smaller">
<h2>KEY FACTOR FUNCTIONS</h2>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>The 2 most essential factor functions for forcats manipulation are from <strong>base R</strong>, not forcats:</p>
</div>
</div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>factor()</strong> - create or coerce factor variable</p>
<p><strong>levels()</strong> - return or set factor levels</p>
</div><div class="column" style="width:50%;">
<h3 id="key-forcats-functions">KEY forcats FUNCTIONS</h3>
<p>forcats functions start with <code>fct_</code></p>
<p>You can do most of these things with just <code>factor()</code> and <code>levels()</code>, but these essentially act like shortcuts for the most common needs</p>
</div></div>
</section>
<section id="forcats-functions" class="slide level2 smaller">
<h2>forcats Functions</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>fct_relevel()</strong> - manually reorder levels</p>
<p><strong>fct_reorder()</strong> - reorder by another variable</p>
<p><strong>fct_infreq()</strong> - reorder by descending frequency (very useful for plots and tables)</p>
<p><strong>fct_rev()</strong> - reverse current level order</p>
</div><div class="column" style="width:50%;">
<p><strong>fct_recode()</strong> - manually change levels</p>
<p><strong>fct_collapse()</strong> - combine levels into manually defined groups</p>
<p><strong>fct_other()</strong> - replace some levels with “other”</p>
<p><strong>fct_drop()</strong> - drop unused levels</p>
<p><strong>fct_expand()</strong> - add level(s)</p>
</div></div>
</section></section>
<section>
<section id="exercises" class="title-slide slide level1 center">
<h1>EXERCISES</h1>
<p><em>(more than usual because this is the only lecture for Week 4)</em></p>
</section>
<section id="w4c1-conceptualize-your-dataset" class="slide level2 smaller">
<h2>W4C1: CONCEPTUALIZE YOUR DATASET</h2>
<p>✓ <strong>Conceptualize the dataset you’ll need to create for your final research project:</strong></p>
<p>This is pretty vague, so some ideas to help get you thinking:</p>
<ul>
<li>Draw out a couple mock figures and/or articulate your questions and hypotheses</li>
<li>How will you need to organize your variables and groups to produce those figures? What data types will your variables need to be?</li>
</ul>
<p>✓ <strong>Mock up a preliminary dataset &amp; begin prep:</strong></p>
<ul>
<li>Create a tabular mock-up of your goal data structure using Excel (or similar) either by manipulating your actual data or creating mock data</li>
<li>You can do this in R, but the goal is to get a solid concept of data structure rather than actually wrangling data</li>
</ul>
</section>
<section class="slide level2">

<p>✓ <strong>In your final research project repo, create an .R script called data-prep.R:</strong></p>
<ul>
<li>Use comments to write out in plain English the steps you need to make your existing data look like your mock-up, including data read-in, wrangling, and write-out of intermediate datasets</li>
<li>Note which steps you do and do not (yet) know how to execute in R</li>
<li>Begin to fill in code where you can e.g., import/export, filtering/selecting, object assignment</li>
</ul>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p><strong>Keep GitHub best practices in mind as you work!</strong><br>
GitHub objectives about version control require showing work over time. Get those practices in place now! You won’t be able to show long-term practices in a short-term timeframe.</p>
</div>
</div>
</div>
<p><em>Unassessed: 1, 9, 14, 16</em></p>
</section>
<section id="w4c1-data-wrangling-practice" class="slide level2 smaller">
<h2>W4C1: DATA WRANGLING PRACTICE</h2>
<p>Find two data wrangling structured exercises in the <strong>d2mr-assessment repo</strong>. Complete the mini-projects directly in the existing .qmd like a digital workbook.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p>✓ <strong>Level 1 Data Wrangling: Recreate a starwars Dataset</strong> - Start with a medium-sized dataset (starwars) and transform the data to match a goal dataset - Most tasks are outlined in the assignment script</p>
<p><em>Associated mini-project:</em><br>
<code>d2mr-assessment/02_data-wrangling/01_recreate-level-1</code></p>
</div><div class="column" style="width:50%;">
<p>✓ <strong>Level 2 Data Wrangling: Recreate a gapminder Dataset</strong> - Work with a more complex dataset (gapminder), perform more involved wrangling and transformation tasks - General guidance is given without much structured support</p>
<p><em>Associated mini-project:</em><br>
<code>d2mr-assessment/02_data-wrangling/02_recreate-level-2</code></p>
</div></div>
<p><em>Assessed: 5, 6, 8, 9, 10, 11, 12; Unassessed: 1, 2, 9, 12, 13</em></p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>As of now (1/23/25) there is an empty directory for a wrangling walkthrough without an actual walkthrough. Between the cleaning walkthrough, the cleaning projects, the in-class demos, and the highly structured format, you should be able to approach Level1 wrangling on your own. I may add one later if I see there is a need for it.</p>
</div>
</div>
</div>
</section>
<section id="w4c1-group-make-a-mess" class="slide level2 smaller">
<h2>W4C1: GROUP MAKE-A-MESS</h2>
<p>Work together with a classmate to each dramatically transform/wrangle a dataset for the other(s) to recreate. This will work best in <strong>pairs</strong> so that you can swap datasets but you can adjust things to do in a small group if you prefer.</p>
<p>✓ Each partner chooses a publicly available dataset (recommend the built-in ones)</p>
<p>✓ In a script or notebook, transform your df using tidyverse functions and save to a .csv</p>
<p>✓ Swap your transformed data files</p>
<p>✓ In a script or notebook, recreate your partner’s transformed dataset</p>
<p>✓ Discuss the process with your partner/group</p>
<p><em>Assessed: 5, 6, 8, 9, 10, 11, 12; Unassessed: 1, 2, 5, 9, 14, 22</em></p>
<p><em>Associated mini-project: <code>02_data-wrangling/03_group-make-a-mess</code></em></p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>This is similar to, but separate from, the “group uncleaning” mini-project. Read the instructions for each carefully. You can complete and submit both!</p>
</div>
</div>
</div>
</section>
<section id="w4c1-data-wrangling-function" class="slide level2 smaller">
<h2>W4C1: DATA WRANGLING FUNCTION</h2>
<p><strong>Define a function to execute procedural data wrangling tasks.</strong> Your final product should be an .R script that defines your function, then runs your function in a variety of test cases.</p>
<p>✓ <strong>Identify a data wrangling problem that needs a solution.</strong> Ideally you should identify a need and develop the concept for your function based on a need you actually have (like something for your research project data wrangling), but you can alternatively select from one of the examples in the mini-project README.</p>
<p>✓ <strong>Conceptually and programmatically define your function.</strong> - Write a “conceptual definition” of the function using plain-English comments. Start broad and narrow as you work. - Fill in the code to match your commented function structure, revising the conceptual definition and comments as needed.</p>
<p>✓ <strong>Run your function on a diverse set of test cases</strong> that would result in the function processing arguments in different ways.</p>
<p><em>Assessed: 6, 7, 8, 9, 10, 11, 12; Unassessed: 1, 2, 3, 4, 5, 8, 12, 13</em></p>
<p><em>Associated mini-project: <code>06_r-programming/03_wrangling-function</code></em></p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>You may use your final research project data to guide the development of your function in this mini-project. This is an exception to the general rule that MPs must be distinct from your research project. Code you submit for this mini-project will not also count toward objectives on your final project.</p>
</div>
</div>
</div>
</section>
<section id="w4c1-recreate-an-existing-function" class="slide level2 smaller">
<h2>W4C1: RECREATE AN EXISTING FUNCTION</h2>
<p><strong>Recreate one or more existing functions from base R or a package of your choice.</strong> Your final product should be an .R script that defines your function, then compares the output with that of the original function.</p>
<p>✓ <strong>Choose an existing function to recreate</strong> from base R, the tidyverse, or another package you are independently familiar with.</p>
<p>✓ <strong>Examine how the existing function is defined.</strong> Try to determine the general logic behind the function and identify which parts you can and can’t follow along with.</p>
<p>✓ <strong>Write a “conceptual definition” of the function using comments.</strong> Focus on outlining the way the function works for your typical use cases, with only the arguments you use.</p>
<p>✓ <strong>Using your conceptual definition to guide you</strong> and revising as you work, fill in as much code as you can to define a function that works like the original.</p>
<p>✓ <strong>Run both your function and the original</strong> on a variety of test cases and compare the output.</p>
<p><em>Assessed: 6, 7, 8, 9, 10, 11, 12; Unassessed: 1, 2, 3, 4, 5, 8, 12, 13</em></p>
<p><em>Associated mini-project: <code>06_r-programming/04_recreate-function</code></em></p>
</section>
<section id="readings-resources" class="slide level2 smaller">
<h2>READINGS &amp; RESOURCES</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="todays-class">Today’s class:</h3>
<p><strong>dplyr joins</strong> - <a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">documentation</a> - r4ds: 19 - joins</p>
<p><strong>tidyr</strong> - <a href="https://tidyr.tidyverse.org/">documentation</a> &amp; <a href="https://github.com/rstudio/cheatsheets/raw/master/data-import.pdf">cheatsheet</a> - <a href="https://tidyr.tidyverse.org/articles/tidy-data.html">tidyverse guide to tidy data</a> - r4ds: 5 – Data tidying*</p>
<p><strong>forcats</strong> - <a href="https://forcats.tidyverse.org/">documentation</a> &amp; <a href="https://github.com/rstudio/cheatsheets/raw/master/factors.pdf">cheatsheet</a> - r4ds: 16 – Factors*</p>
</div><div class="column" style="width:50%;">
<p><strong>stringr</strong> - <a href="https://stringr.tidyverse.org/">documentation</a> &amp; <a href="https://github.com/rstudio/cheatsheets/raw/master/strings.pdf">cheatsheet</a> - r4ds: 14 – Strings* - r4ds: 15 – Regular expressions</p>
<p><strong>purrr</strong> <em>(advanced, low priority for d2m)</em> - <a href="https://purrr.tidyverse.org/">documentation</a> &amp; <a href="https://github.com/rstudio/cheatsheets/raw/master/purrr.pdf">cheatsheet</a></p>
<h3 id="next-class">Next class:</h3>
<ul>
<li><strong>Data preparation workshop</strong> – no new material!</li>
<li>We will catch up on anything we didn’t get to in the Tidyverse lectures, then have dedicated time to walk through demo scripts, work on projects, and get in-class support.</li>
<li>Review the documentation and cheatsheets for readr, tidyr, dplyr, stringr, and forcats as well as the chapters on data tidying and data types in R for Data Science</li>
</ul>
</div></div>
</section>
<section id="speaker-notes" class="slide level2 notes scrollable">
<h2>Speaker Notes</h2>
<p>This slide deck covers the core concepts of data tidying and wrangling using the tidyverse packages. Key points to emphasize:</p>
<ol type="1">
<li><strong>Git Best Practices</strong>: Start every session with pull, end with commit and push</li>
<li><strong>Tidyverse Philosophy</strong>: All packages work together with tidy data principles</li>
<li><strong>Joins vs Binds</strong>: Prefer joins over binding columns for data integrity</li>
<li><strong>Tidy Data</strong>: Each variable is a column, each observation is a row</li>
<li><strong>Pivoting</strong>: Wide data is human-readable, long data is analysis-ready</li>
<li><strong>String Manipulation</strong>: stringr functions are more intuitive than base R</li>
<li><strong>Factors</strong>: Essential for categorical data analysis and visualization</li>
</ol>
<p>Make sure to demonstrate live coding examples for each major function discussed. Encourage students to follow along with the demo-snippets.R file.</p>

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p>D2M-R Q# | Week # Class #</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="tidying-wrangling-data_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="tidying-wrangling-data_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="tidying-wrangling-data_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="tidying-wrangling-data_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="tidying-wrangling-data_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="tidying-wrangling-data_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="tidying-wrangling-data_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="tidying-wrangling-data_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="tidying-wrangling-data_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="tidying-wrangling-data_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="tidying-wrangling-data_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>